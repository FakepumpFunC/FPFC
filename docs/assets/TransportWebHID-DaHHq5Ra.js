import{a as z,g as ot,c as ct,l as sr,D as ut,d as lt,e as nr}from"./index-B0gxhfGN.js";const ir=5;function ft(t){const a=Buffer.alloc(2);return a.writeUInt16BE(t,0),a}const ht={data:Buffer.alloc(0),dataLength:0,sequence:0},dt=(t,a)=>({makeBlocks(s){let r=Buffer.concat([ft(s.length),s]);const n=a-5,l=Math.ceil(r.length/n);r=Buffer.concat([r,Buffer.alloc(l*n-r.length+1).fill(0)]);const o=[];for(let f=0;f<l;f++){const i=Buffer.alloc(5);i.writeUInt16BE(t,0),i.writeUInt8(ir,2),i.writeUInt16BE(f,3);const h=r.slice(f*n,(f+1)*n);o.push(Buffer.concat([i,h]))}return o},reduceResponse(s,r){let{data:n,dataLength:l,sequence:o}=s||ht;if(r.readUInt16BE(0)!==t)throw new z("Invalid channel","InvalidChannel");if(r.readUInt8(2)!==ir)throw new z("Invalid tag","InvalidTag");if(r.readUInt16BE(3)!==o)throw new z("Invalid sequence","InvalidSequence");s||(l=r.readUInt16BE(5)),o++;const f=r.slice(s?5:7);return n=Buffer.concat([n,f]),n.length>l&&(n=n.slice(0,l)),{data:n,dataLength:l,sequence:o}},getReducedResult(s){if(s&&s.dataLength===s.data.length)return s.data}});var Y={exports:{}},ie,ar;function K(){if(ar)return ie;ar=1;const t="2.0.0",a=256,s=Number.MAX_SAFE_INTEGER||9007199254740991,r=16,n=a-6;return ie={MAX_LENGTH:a,MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:n,MAX_SAFE_INTEGER:s,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:t,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},ie}var ae,or;function Z(){if(or)return ae;or=1;var t={};return ae=typeof process=="object"&&t&&t.NODE_DEBUG&&/\bsemver\b/i.test(t.NODE_DEBUG)?(...s)=>console.error("SEMVER",...s):()=>{},ae}var cr;function H(){return cr||(cr=1,function(t,a){const{MAX_SAFE_COMPONENT_LENGTH:s,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:n}=K(),l=Z();a=t.exports={};const o=a.re=[],f=a.safeRe=[],i=a.src=[],h=a.safeSrc=[],e=a.t={};let c=0;const u="[a-zA-Z0-9-]",p=[["\\s",1],["\\d",n],[u,r]],S=O=>{for(const[A,x]of p)O=O.split(`${A}*`).join(`${A}{0,${x}}`).split(`${A}+`).join(`${A}{1,${x}}`);return O},E=(O,A,x)=>{const T=S(A),U=c++;l(O,U,A),e[O]=U,i[U]=A,h[U]=T,o[U]=new RegExp(A,x?"g":void 0),f[U]=new RegExp(T,x?"g":void 0)};E("NUMERICIDENTIFIER","0|[1-9]\\d*"),E("NUMERICIDENTIFIERLOOSE","\\d+"),E("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${u}*`),E("MAINVERSION",`(${i[e.NUMERICIDENTIFIER]})\\.(${i[e.NUMERICIDENTIFIER]})\\.(${i[e.NUMERICIDENTIFIER]})`),E("MAINVERSIONLOOSE",`(${i[e.NUMERICIDENTIFIERLOOSE]})\\.(${i[e.NUMERICIDENTIFIERLOOSE]})\\.(${i[e.NUMERICIDENTIFIERLOOSE]})`),E("PRERELEASEIDENTIFIER",`(?:${i[e.NUMERICIDENTIFIER]}|${i[e.NONNUMERICIDENTIFIER]})`),E("PRERELEASEIDENTIFIERLOOSE",`(?:${i[e.NUMERICIDENTIFIERLOOSE]}|${i[e.NONNUMERICIDENTIFIER]})`),E("PRERELEASE",`(?:-(${i[e.PRERELEASEIDENTIFIER]}(?:\\.${i[e.PRERELEASEIDENTIFIER]})*))`),E("PRERELEASELOOSE",`(?:-?(${i[e.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${i[e.PRERELEASEIDENTIFIERLOOSE]})*))`),E("BUILDIDENTIFIER",`${u}+`),E("BUILD",`(?:\\+(${i[e.BUILDIDENTIFIER]}(?:\\.${i[e.BUILDIDENTIFIER]})*))`),E("FULLPLAIN",`v?${i[e.MAINVERSION]}${i[e.PRERELEASE]}?${i[e.BUILD]}?`),E("FULL",`^${i[e.FULLPLAIN]}$`),E("LOOSEPLAIN",`[v=\\s]*${i[e.MAINVERSIONLOOSE]}${i[e.PRERELEASELOOSE]}?${i[e.BUILD]}?`),E("LOOSE",`^${i[e.LOOSEPLAIN]}$`),E("GTLT","((?:<|>)?=?)"),E("XRANGEIDENTIFIERLOOSE",`${i[e.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),E("XRANGEIDENTIFIER",`${i[e.NUMERICIDENTIFIER]}|x|X|\\*`),E("XRANGEPLAIN",`[v=\\s]*(${i[e.XRANGEIDENTIFIER]})(?:\\.(${i[e.XRANGEIDENTIFIER]})(?:\\.(${i[e.XRANGEIDENTIFIER]})(?:${i[e.PRERELEASE]})?${i[e.BUILD]}?)?)?`),E("XRANGEPLAINLOOSE",`[v=\\s]*(${i[e.XRANGEIDENTIFIERLOOSE]})(?:\\.(${i[e.XRANGEIDENTIFIERLOOSE]})(?:\\.(${i[e.XRANGEIDENTIFIERLOOSE]})(?:${i[e.PRERELEASELOOSE]})?${i[e.BUILD]}?)?)?`),E("XRANGE",`^${i[e.GTLT]}\\s*${i[e.XRANGEPLAIN]}$`),E("XRANGELOOSE",`^${i[e.GTLT]}\\s*${i[e.XRANGEPLAINLOOSE]}$`),E("COERCEPLAIN",`(^|[^\\d])(\\d{1,${s}})(?:\\.(\\d{1,${s}}))?(?:\\.(\\d{1,${s}}))?`),E("COERCE",`${i[e.COERCEPLAIN]}(?:$|[^\\d])`),E("COERCEFULL",i[e.COERCEPLAIN]+`(?:${i[e.PRERELEASE]})?(?:${i[e.BUILD]})?(?:$|[^\\d])`),E("COERCERTL",i[e.COERCE],!0),E("COERCERTLFULL",i[e.COERCEFULL],!0),E("LONETILDE","(?:~>?)"),E("TILDETRIM",`(\\s*)${i[e.LONETILDE]}\\s+`,!0),a.tildeTrimReplace="$1~",E("TILDE",`^${i[e.LONETILDE]}${i[e.XRANGEPLAIN]}$`),E("TILDELOOSE",`^${i[e.LONETILDE]}${i[e.XRANGEPLAINLOOSE]}$`),E("LONECARET","(?:\\^)"),E("CARETTRIM",`(\\s*)${i[e.LONECARET]}\\s+`,!0),a.caretTrimReplace="$1^",E("CARET",`^${i[e.LONECARET]}${i[e.XRANGEPLAIN]}$`),E("CARETLOOSE",`^${i[e.LONECARET]}${i[e.XRANGEPLAINLOOSE]}$`),E("COMPARATORLOOSE",`^${i[e.GTLT]}\\s*(${i[e.LOOSEPLAIN]})$|^$`),E("COMPARATOR",`^${i[e.GTLT]}\\s*(${i[e.FULLPLAIN]})$|^$`),E("COMPARATORTRIM",`(\\s*)${i[e.GTLT]}\\s*(${i[e.LOOSEPLAIN]}|${i[e.XRANGEPLAIN]})`,!0),a.comparatorTrimReplace="$1$2$3",E("HYPHENRANGE",`^\\s*(${i[e.XRANGEPLAIN]})\\s+-\\s+(${i[e.XRANGEPLAIN]})\\s*$`),E("HYPHENRANGELOOSE",`^\\s*(${i[e.XRANGEPLAINLOOSE]})\\s+-\\s+(${i[e.XRANGEPLAINLOOSE]})\\s*$`),E("STAR","(<|>)?=?\\s*\\*"),E("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),E("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(Y,Y.exports)),Y.exports}var oe,ur;function Ke(){if(ur)return oe;ur=1;const t=Object.freeze({loose:!0}),a=Object.freeze({});return oe=r=>r?typeof r!="object"?t:r:a,oe}var ce,lr;function et(){if(lr)return ce;lr=1;const t=/^[0-9]+$/,a=(r,n)=>{const l=t.test(r),o=t.test(n);return l&&o&&(r=+r,n=+n),r===n?0:l&&!o?-1:o&&!l?1:r<n?-1:1};return ce={compareIdentifiers:a,rcompareIdentifiers:(r,n)=>a(n,r)},ce}var ue,fr;function b(){if(fr)return ue;fr=1;const t=Z(),{MAX_LENGTH:a,MAX_SAFE_INTEGER:s}=K(),{safeRe:r,safeSrc:n,t:l}=H(),o=Ke(),{compareIdentifiers:f}=et();class i{constructor(e,c){if(c=o(c),e instanceof i){if(e.loose===!!c.loose&&e.includePrerelease===!!c.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>a)throw new TypeError(`version is longer than ${a} characters`);t("SemVer",e,c),this.options=c,this.loose=!!c.loose,this.includePrerelease=!!c.includePrerelease;const u=e.trim().match(c.loose?r[l.LOOSE]:r[l.FULL]);if(!u)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+u[1],this.minor=+u[2],this.patch=+u[3],this.major>s||this.major<0)throw new TypeError("Invalid major version");if(this.minor>s||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>s||this.patch<0)throw new TypeError("Invalid patch version");u[4]?this.prerelease=u[4].split(".").map(p=>{if(/^[0-9]+$/.test(p)){const S=+p;if(S>=0&&S<s)return S}return p}):this.prerelease=[],this.build=u[5]?u[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(t("SemVer.compare",this.version,this.options,e),!(e instanceof i)){if(typeof e=="string"&&e===this.version)return 0;e=new i(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof i||(e=new i(e,this.options)),f(this.major,e.major)||f(this.minor,e.minor)||f(this.patch,e.patch)}comparePre(e){if(e instanceof i||(e=new i(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let c=0;do{const u=this.prerelease[c],p=e.prerelease[c];if(t("prerelease compare",c,u,p),u===void 0&&p===void 0)return 0;if(p===void 0)return 1;if(u===void 0)return-1;if(u===p)continue;return f(u,p)}while(++c)}compareBuild(e){e instanceof i||(e=new i(e,this.options));let c=0;do{const u=this.build[c],p=e.build[c];if(t("build compare",c,u,p),u===void 0&&p===void 0)return 0;if(p===void 0)return 1;if(u===void 0)return-1;if(u===p)continue;return f(u,p)}while(++c)}inc(e,c,u){if(e.startsWith("pre")){if(!c&&u===!1)throw new Error("invalid increment argument: identifier is empty");if(c){const p=new RegExp(`^${this.options.loose?n[l.PRERELEASELOOSE]:n[l.PRERELEASE]}$`),S=`-${c}`.match(p);if(!S||S[1]!==c)throw new Error(`invalid identifier: ${c}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",c,u);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",c,u);break;case"prepatch":this.prerelease.length=0,this.inc("patch",c,u),this.inc("pre",c,u);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",c,u),this.inc("pre",c,u);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const p=Number(u)?1:0;if(this.prerelease.length===0)this.prerelease=[p];else{let S=this.prerelease.length;for(;--S>=0;)typeof this.prerelease[S]=="number"&&(this.prerelease[S]++,S=-2);if(S===-1){if(c===this.prerelease.join(".")&&u===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(p)}}if(c){let S=[c,p];u===!1&&(S=[c]),f(this.prerelease[0],c)===0?isNaN(this.prerelease[1])&&(this.prerelease=S):this.prerelease=S}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return ue=i,ue}var le,hr;function V(){if(hr)return le;hr=1;const t=b();return le=(s,r,n=!1)=>{if(s instanceof t)return s;try{return new t(s,r)}catch(l){if(!n)return null;throw l}},le}var fe,dr;function Et(){if(dr)return fe;dr=1;const t=V();return fe=(s,r)=>{const n=t(s,r);return n?n.version:null},fe}var he,Er;function pt(){if(Er)return he;Er=1;const t=V();return he=(s,r)=>{const n=t(s.trim().replace(/^[=v]+/,""),r);return n?n.version:null},he}var de,pr;function mt(){if(pr)return de;pr=1;const t=b();return de=(s,r,n,l,o)=>{typeof n=="string"&&(o=l,l=n,n=void 0);try{return new t(s instanceof t?s.version:s,n).inc(r,l,o).version}catch{return null}},de}var Ee,mr;function Rt(){if(mr)return Ee;mr=1;const t=V();return Ee=(s,r)=>{const n=t(s,null,!0),l=t(r,null,!0),o=n.compare(l);if(o===0)return null;const f=o>0,i=f?n:l,h=f?l:n,e=!!i.prerelease.length;if(!!h.prerelease.length&&!e){if(!h.patch&&!h.minor)return"major";if(h.compareMain(i)===0)return h.minor&&!h.patch?"minor":"patch"}const u=e?"pre":"";return n.major!==l.major?u+"major":n.minor!==l.minor?u+"minor":n.patch!==l.patch?u+"patch":"prerelease"},Ee}var pe,Rr;function vt(){if(Rr)return pe;Rr=1;const t=b();return pe=(s,r)=>new t(s,r).major,pe}var me,vr;function It(){if(vr)return me;vr=1;const t=b();return me=(s,r)=>new t(s,r).minor,me}var Re,Ir;function $t(){if(Ir)return Re;Ir=1;const t=b();return Re=(s,r)=>new t(s,r).patch,Re}var ve,$r;function St(){if($r)return ve;$r=1;const t=V();return ve=(s,r)=>{const n=t(s,r);return n&&n.prerelease.length?n.prerelease:null},ve}var Ie,Sr;function j(){if(Sr)return Ie;Sr=1;const t=b();return Ie=(s,r,n)=>new t(s,n).compare(new t(r,n)),Ie}var $e,Lr;function Lt(){if(Lr)return $e;Lr=1;const t=j();return $e=(s,r,n)=>t(r,s,n),$e}var Se,gr;function gt(){if(gr)return Se;gr=1;const t=j();return Se=(s,r)=>t(s,r,!0),Se}var Le,Nr;function Ze(){if(Nr)return Le;Nr=1;const t=b();return Le=(s,r,n)=>{const l=new t(s,n),o=new t(r,n);return l.compare(o)||l.compareBuild(o)},Le}var ge,Or;function Nt(){if(Or)return ge;Or=1;const t=Ze();return ge=(s,r)=>s.sort((n,l)=>t(n,l,r)),ge}var Ne,wr;function Ot(){if(wr)return Ne;wr=1;const t=Ze();return Ne=(s,r)=>s.sort((n,l)=>t(l,n,r)),Ne}var Oe,Ar;function J(){if(Ar)return Oe;Ar=1;const t=j();return Oe=(s,r,n)=>t(s,r,n)>0,Oe}var we,Tr;function Je(){if(Tr)return we;Tr=1;const t=j();return we=(s,r,n)=>t(s,r,n)<0,we}var Ae,Pr;function rt(){if(Pr)return Ae;Pr=1;const t=j();return Ae=(s,r,n)=>t(s,r,n)===0,Ae}var Te,qr;function tt(){if(qr)return Te;qr=1;const t=j();return Te=(s,r,n)=>t(s,r,n)!==0,Te}var Pe,Cr;function Qe(){if(Cr)return Pe;Cr=1;const t=j();return Pe=(s,r,n)=>t(s,r,n)>=0,Pe}var qe,yr;function er(){if(yr)return qe;yr=1;const t=j();return qe=(s,r,n)=>t(s,r,n)<=0,qe}var Ce,Dr;function st(){if(Dr)return Ce;Dr=1;const t=rt(),a=tt(),s=J(),r=Qe(),n=Je(),l=er();return Ce=(f,i,h,e)=>{switch(i){case"===":return typeof f=="object"&&(f=f.version),typeof h=="object"&&(h=h.version),f===h;case"!==":return typeof f=="object"&&(f=f.version),typeof h=="object"&&(h=h.version),f!==h;case"":case"=":case"==":return t(f,h,e);case"!=":return a(f,h,e);case">":return s(f,h,e);case">=":return r(f,h,e);case"<":return n(f,h,e);case"<=":return l(f,h,e);default:throw new TypeError(`Invalid operator: ${i}`)}},Ce}var ye,xr;function wt(){if(xr)return ye;xr=1;const t=b(),a=V(),{safeRe:s,t:r}=H();return ye=(l,o)=>{if(l instanceof t)return l;if(typeof l=="number"&&(l=String(l)),typeof l!="string")return null;o=o||{};let f=null;if(!o.rtl)f=l.match(o.includePrerelease?s[r.COERCEFULL]:s[r.COERCE]);else{const p=o.includePrerelease?s[r.COERCERTLFULL]:s[r.COERCERTL];let S;for(;(S=p.exec(l))&&(!f||f.index+f[0].length!==l.length);)(!f||S.index+S[0].length!==f.index+f[0].length)&&(f=S),p.lastIndex=S.index+S[1].length+S[2].length;p.lastIndex=-1}if(f===null)return null;const i=f[2],h=f[3]||"0",e=f[4]||"0",c=o.includePrerelease&&f[5]?`-${f[5]}`:"",u=o.includePrerelease&&f[6]?`+${f[6]}`:"";return a(`${i}.${h}.${e}${c}${u}`,o)},ye}var De,Ur;function At(){if(Ur)return De;Ur=1;class t{constructor(){this.max=1e3,this.map=new Map}get(s){const r=this.map.get(s);if(r!==void 0)return this.map.delete(s),this.map.set(s,r),r}delete(s){return this.map.delete(s)}set(s,r){if(!this.delete(s)&&r!==void 0){if(this.map.size>=this.max){const l=this.map.keys().next().value;this.delete(l)}this.map.set(s,r)}return this}}return De=t,De}var xe,_r;function F(){if(_r)return xe;_r=1;const t=/\s+/g;class a{constructor(d,I){if(I=n(I),d instanceof a)return d.loose===!!I.loose&&d.includePrerelease===!!I.includePrerelease?d:new a(d.raw,I);if(d instanceof l)return this.raw=d.value,this.set=[[d]],this.formatted=void 0,this;if(this.options=I,this.loose=!!I.loose,this.includePrerelease=!!I.includePrerelease,this.raw=d.trim().replace(t," "),this.set=this.raw.split("||").map(R=>this.parseRange(R.trim())).filter(R=>R.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const R=this.set[0];if(this.set=this.set.filter($=>!E($[0])),this.set.length===0)this.set=[R];else if(this.set.length>1){for(const $ of this.set)if($.length===1&&O($[0])){this.set=[$];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let d=0;d<this.set.length;d++){d>0&&(this.formatted+="||");const I=this.set[d];for(let R=0;R<I.length;R++)R>0&&(this.formatted+=" "),this.formatted+=I[R].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(d){const R=((this.options.includePrerelease&&p)|(this.options.loose&&S))+":"+d,$=r.get(R);if($)return $;const v=this.options.loose,L=v?i[h.HYPHENRANGELOOSE]:i[h.HYPHENRANGE];d=d.replace(L,se(this.options.includePrerelease)),o("hyphen replace",d),d=d.replace(i[h.COMPARATORTRIM],e),o("comparator trim",d),d=d.replace(i[h.TILDETRIM],c),o("tilde trim",d),d=d.replace(i[h.CARETTRIM],u),o("caret trim",d);let w=d.split(" ").map(C=>x(C,this.options)).join(" ").split(/\s+/).map(C=>te(C,this.options));v&&(w=w.filter(C=>(o("loose invalid filter",C,this.options),!!C.match(i[h.COMPARATORLOOSE])))),o("range list",w);const N=new Map,P=w.map(C=>new l(C,this.options));for(const C of P){if(E(C))return[C];N.set(C.value,C)}N.size>1&&N.has("")&&N.delete("");const _=[...N.values()];return r.set(R,_),_}intersects(d,I){if(!(d instanceof a))throw new TypeError("a Range is required");return this.set.some(R=>A(R,I)&&d.set.some($=>A($,I)&&R.every(v=>$.every(L=>v.intersects(L,I)))))}test(d){if(!d)return!1;if(typeof d=="string")try{d=new f(d,this.options)}catch{return!1}for(let I=0;I<this.set.length;I++)if(ne(this.set[I],d,this.options))return!0;return!1}}xe=a;const s=At(),r=new s,n=Ke(),l=Q(),o=Z(),f=b(),{safeRe:i,t:h,comparatorTrimReplace:e,tildeTrimReplace:c,caretTrimReplace:u}=H(),{FLAG_INCLUDE_PRERELEASE:p,FLAG_LOOSE:S}=K(),E=m=>m.value==="<0.0.0-0",O=m=>m.value==="",A=(m,d)=>{let I=!0;const R=m.slice();let $=R.pop();for(;I&&R.length;)I=R.every(v=>$.intersects(v,d)),$=R.pop();return I},x=(m,d)=>(o("comp",m,d),m=q(m,d),o("caret",m),m=U(m,d),o("tildes",m),m=g(m,d),o("xrange",m),m=re(m,d),o("stars",m),m),T=m=>!m||m.toLowerCase()==="x"||m==="*",U=(m,d)=>m.trim().split(/\s+/).map(I=>G(I,d)).join(" "),G=(m,d)=>{const I=d.loose?i[h.TILDELOOSE]:i[h.TILDE];return m.replace(I,(R,$,v,L,w)=>{o("tilde",m,R,$,v,L,w);let N;return T($)?N="":T(v)?N=`>=${$}.0.0 <${+$+1}.0.0-0`:T(L)?N=`>=${$}.${v}.0 <${$}.${+v+1}.0-0`:w?(o("replaceTilde pr",w),N=`>=${$}.${v}.${L}-${w} <${$}.${+v+1}.0-0`):N=`>=${$}.${v}.${L} <${$}.${+v+1}.0-0`,o("tilde return",N),N})},q=(m,d)=>m.trim().split(/\s+/).map(I=>D(I,d)).join(" "),D=(m,d)=>{o("caret",m,d);const I=d.loose?i[h.CARETLOOSE]:i[h.CARET],R=d.includePrerelease?"-0":"";return m.replace(I,($,v,L,w,N)=>{o("caret",m,$,v,L,w,N);let P;return T(v)?P="":T(L)?P=`>=${v}.0.0${R} <${+v+1}.0.0-0`:T(w)?v==="0"?P=`>=${v}.${L}.0${R} <${v}.${+L+1}.0-0`:P=`>=${v}.${L}.0${R} <${+v+1}.0.0-0`:N?(o("replaceCaret pr",N),v==="0"?L==="0"?P=`>=${v}.${L}.${w}-${N} <${v}.${L}.${+w+1}-0`:P=`>=${v}.${L}.${w}-${N} <${v}.${+L+1}.0-0`:P=`>=${v}.${L}.${w}-${N} <${+v+1}.0.0-0`):(o("no pr"),v==="0"?L==="0"?P=`>=${v}.${L}.${w}${R} <${v}.${L}.${+w+1}-0`:P=`>=${v}.${L}.${w}${R} <${v}.${+L+1}.0-0`:P=`>=${v}.${L}.${w} <${+v+1}.0.0-0`),o("caret return",P),P})},g=(m,d)=>(o("replaceXRanges",m,d),m.split(/\s+/).map(I=>k(I,d)).join(" ")),k=(m,d)=>{m=m.trim();const I=d.loose?i[h.XRANGELOOSE]:i[h.XRANGE];return m.replace(I,(R,$,v,L,w,N)=>{o("xRange",m,R,$,v,L,w,N);const P=T(v),_=P||T(L),C=_||T(w),M=C;return $==="="&&M&&($=""),N=d.includePrerelease?"-0":"",P?$===">"||$==="<"?R="<0.0.0-0":R="*":$&&M?(_&&(L=0),w=0,$===">"?($=">=",_?(v=+v+1,L=0,w=0):(L=+L+1,w=0)):$==="<="&&($="<",_?v=+v+1:L=+L+1),$==="<"&&(N="-0"),R=`${$+v}.${L}.${w}${N}`):_?R=`>=${v}.0.0${N} <${+v+1}.0.0-0`:C&&(R=`>=${v}.${L}.0${N} <${v}.${+L+1}.0-0`),o("xRange return",R),R})},re=(m,d)=>(o("replaceStars",m,d),m.trim().replace(i[h.STAR],"")),te=(m,d)=>(o("replaceGTE0",m,d),m.trim().replace(i[d.includePrerelease?h.GTE0PRE:h.GTE0],"")),se=m=>(d,I,R,$,v,L,w,N,P,_,C,M)=>(T(R)?I="":T($)?I=`>=${R}.0.0${m?"-0":""}`:T(v)?I=`>=${R}.${$}.0${m?"-0":""}`:L?I=`>=${I}`:I=`>=${I}${m?"-0":""}`,T(P)?N="":T(_)?N=`<${+P+1}.0.0-0`:T(C)?N=`<${P}.${+_+1}.0-0`:M?N=`<=${P}.${_}.${C}-${M}`:m?N=`<${P}.${_}.${+C+1}-0`:N=`<=${N}`,`${I} ${N}`.trim()),ne=(m,d,I)=>{for(let R=0;R<m.length;R++)if(!m[R].test(d))return!1;if(d.prerelease.length&&!I.includePrerelease){for(let R=0;R<m.length;R++)if(o(m[R].semver),m[R].semver!==l.ANY&&m[R].semver.prerelease.length>0){const $=m[R].semver;if($.major===d.major&&$.minor===d.minor&&$.patch===d.patch)return!0}return!1}return!0};return xe}var Ue,br;function Q(){if(br)return Ue;br=1;const t=Symbol("SemVer ANY");class a{static get ANY(){return t}constructor(e,c){if(c=s(c),e instanceof a){if(e.loose===!!c.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),o("comparator",e,c),this.options=c,this.loose=!!c.loose,this.parse(e),this.semver===t?this.value="":this.value=this.operator+this.semver.version,o("comp",this)}parse(e){const c=this.options.loose?r[n.COMPARATORLOOSE]:r[n.COMPARATOR],u=e.match(c);if(!u)throw new TypeError(`Invalid comparator: ${e}`);this.operator=u[1]!==void 0?u[1]:"",this.operator==="="&&(this.operator=""),u[2]?this.semver=new f(u[2],this.options.loose):this.semver=t}toString(){return this.value}test(e){if(o("Comparator.test",e,this.options.loose),this.semver===t||e===t)return!0;if(typeof e=="string")try{e=new f(e,this.options)}catch{return!1}return l(e,this.operator,this.semver,this.options)}intersects(e,c){if(!(e instanceof a))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new i(e.value,c).test(this.value):e.operator===""?e.value===""?!0:new i(this.value,c).test(e.semver):(c=s(c),c.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!c.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||l(this.semver,"<",e.semver,c)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||l(this.semver,">",e.semver,c)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}}Ue=a;const s=Ke(),{safeRe:r,t:n}=H(),l=st(),o=Z(),f=b(),i=F();return Ue}var _e,Gr;function ee(){if(Gr)return _e;Gr=1;const t=F();return _e=(s,r,n)=>{try{r=new t(r,n)}catch{return!1}return r.test(s)},_e}var be,jr;function Tt(){if(jr)return be;jr=1;const t=F();return be=(s,r)=>new t(s,r).set.map(n=>n.map(l=>l.value).join(" ").trim().split(" ")),be}var Ge,Fr;function Pt(){if(Fr)return Ge;Fr=1;const t=b(),a=F();return Ge=(r,n,l)=>{let o=null,f=null,i=null;try{i=new a(n,l)}catch{return null}return r.forEach(h=>{i.test(h)&&(!o||f.compare(h)===-1)&&(o=h,f=new t(o,l))}),o},Ge}var je,Xr;function qt(){if(Xr)return je;Xr=1;const t=b(),a=F();return je=(r,n,l)=>{let o=null,f=null,i=null;try{i=new a(n,l)}catch{return null}return r.forEach(h=>{i.test(h)&&(!o||f.compare(h)===1)&&(o=h,f=new t(o,l))}),o},je}var Fe,Br;function Ct(){if(Br)return Fe;Br=1;const t=b(),a=F(),s=J();return Fe=(n,l)=>{n=new a(n,l);let o=new t("0.0.0");if(n.test(o)||(o=new t("0.0.0-0"),n.test(o)))return o;o=null;for(let f=0;f<n.set.length;++f){const i=n.set[f];let h=null;i.forEach(e=>{const c=new t(e.semver.version);switch(e.operator){case">":c.prerelease.length===0?c.patch++:c.prerelease.push(0),c.raw=c.format();case"":case">=":(!h||s(c,h))&&(h=c);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}}),h&&(!o||s(o,h))&&(o=h)}return o&&n.test(o)?o:null},Fe}var Xe,Vr;function yt(){if(Vr)return Xe;Vr=1;const t=F();return Xe=(s,r)=>{try{return new t(s,r).range||"*"}catch{return null}},Xe}var Be,kr;function rr(){if(kr)return Be;kr=1;const t=b(),a=Q(),{ANY:s}=a,r=F(),n=ee(),l=J(),o=Je(),f=er(),i=Qe();return Be=(e,c,u,p)=>{e=new t(e,p),c=new r(c,p);let S,E,O,A,x;switch(u){case">":S=l,E=f,O=o,A=">",x=">=";break;case"<":S=o,E=i,O=l,A="<",x="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(n(e,c,p))return!1;for(let T=0;T<c.set.length;++T){const U=c.set[T];let G=null,q=null;if(U.forEach(D=>{D.semver===s&&(D=new a(">=0.0.0")),G=G||D,q=q||D,S(D.semver,G.semver,p)?G=D:O(D.semver,q.semver,p)&&(q=D)}),G.operator===A||G.operator===x||(!q.operator||q.operator===A)&&E(e,q.semver))return!1;if(q.operator===x&&O(e,q.semver))return!1}return!0},Be}var Ve,Mr;function Dt(){if(Mr)return Ve;Mr=1;const t=rr();return Ve=(s,r,n)=>t(s,r,">",n),Ve}var ke,zr;function xt(){if(zr)return ke;zr=1;const t=rr();return ke=(s,r,n)=>t(s,r,"<",n),ke}var Me,Hr;function Ut(){if(Hr)return Me;Hr=1;const t=F();return Me=(s,r,n)=>(s=new t(s,n),r=new t(r,n),s.intersects(r,n)),Me}var ze,Yr;function _t(){if(Yr)return ze;Yr=1;const t=ee(),a=j();return ze=(s,r,n)=>{const l=[];let o=null,f=null;const i=s.sort((u,p)=>a(u,p,n));for(const u of i)t(u,r,n)?(f=u,o||(o=u)):(f&&l.push([o,f]),f=null,o=null);o&&l.push([o,null]);const h=[];for(const[u,p]of l)u===p?h.push(u):!p&&u===i[0]?h.push("*"):p?u===i[0]?h.push(`<=${p}`):h.push(`${u} - ${p}`):h.push(`>=${u}`);const e=h.join(" || "),c=typeof r.raw=="string"?r.raw:String(r);return e.length<c.length?e:r},ze}var He,Wr;function bt(){if(Wr)return He;Wr=1;const t=F(),a=Q(),{ANY:s}=a,r=ee(),n=j(),l=(c,u,p={})=>{if(c===u)return!0;c=new t(c,p),u=new t(u,p);let S=!1;e:for(const E of c.set){for(const O of u.set){const A=i(E,O,p);if(S=S||A!==null,A)continue e}if(S)return!1}return!0},o=[new a(">=0.0.0-0")],f=[new a(">=0.0.0")],i=(c,u,p)=>{if(c===u)return!0;if(c.length===1&&c[0].semver===s){if(u.length===1&&u[0].semver===s)return!0;p.includePrerelease?c=o:c=f}if(u.length===1&&u[0].semver===s){if(p.includePrerelease)return!0;u=f}const S=new Set;let E,O;for(const g of c)g.operator===">"||g.operator===">="?E=h(E,g,p):g.operator==="<"||g.operator==="<="?O=e(O,g,p):S.add(g.semver);if(S.size>1)return null;let A;if(E&&O){if(A=n(E.semver,O.semver,p),A>0)return null;if(A===0&&(E.operator!==">="||O.operator!=="<="))return null}for(const g of S){if(E&&!r(g,String(E),p)||O&&!r(g,String(O),p))return null;for(const k of u)if(!r(g,String(k),p))return!1;return!0}let x,T,U,G,q=O&&!p.includePrerelease&&O.semver.prerelease.length?O.semver:!1,D=E&&!p.includePrerelease&&E.semver.prerelease.length?E.semver:!1;q&&q.prerelease.length===1&&O.operator==="<"&&q.prerelease[0]===0&&(q=!1);for(const g of u){if(G=G||g.operator===">"||g.operator===">=",U=U||g.operator==="<"||g.operator==="<=",E){if(D&&g.semver.prerelease&&g.semver.prerelease.length&&g.semver.major===D.major&&g.semver.minor===D.minor&&g.semver.patch===D.patch&&(D=!1),g.operator===">"||g.operator===">="){if(x=h(E,g,p),x===g&&x!==E)return!1}else if(E.operator===">="&&!r(E.semver,String(g),p))return!1}if(O){if(q&&g.semver.prerelease&&g.semver.prerelease.length&&g.semver.major===q.major&&g.semver.minor===q.minor&&g.semver.patch===q.patch&&(q=!1),g.operator==="<"||g.operator==="<="){if(T=e(O,g,p),T===g&&T!==O)return!1}else if(O.operator==="<="&&!r(O.semver,String(g),p))return!1}if(!g.operator&&(O||E)&&A!==0)return!1}return!(E&&U&&!O&&A!==0||O&&G&&!E&&A!==0||D||q)},h=(c,u,p)=>{if(!c)return u;const S=n(c.semver,u.semver,p);return S>0?c:S<0||u.operator===">"&&c.operator===">="?u:c},e=(c,u,p)=>{if(!c)return u;const S=n(c.semver,u.semver,p);return S<0?c:S>0||u.operator==="<"&&c.operator==="<="?u:c};return He=l,He}var Ye,Kr;function Gt(){if(Kr)return Ye;Kr=1;const t=H(),a=K(),s=b(),r=et(),n=V(),l=Et(),o=pt(),f=mt(),i=Rt(),h=vt(),e=It(),c=$t(),u=St(),p=j(),S=Lt(),E=gt(),O=Ze(),A=Nt(),x=Ot(),T=J(),U=Je(),G=rt(),q=tt(),D=Qe(),g=er(),k=st(),re=wt(),te=Q(),se=F(),ne=ee(),m=Tt(),d=Pt(),I=qt(),R=Ct(),$=yt(),v=rr(),L=Dt(),w=xt(),N=Ut(),P=_t(),_=bt();return Ye={parse:n,valid:l,clean:o,inc:f,diff:i,major:h,minor:e,patch:c,prerelease:u,compare:p,rcompare:S,compareLoose:E,compareBuild:O,sort:A,rsort:x,gt:T,lt:U,eq:G,neq:q,gte:D,lte:g,cmp:k,coerce:re,Comparator:te,Range:se,satisfies:ne,toComparators:m,maxSatisfying:d,minSatisfying:I,minVersion:R,validRange:$,outside:v,gtr:L,ltr:w,intersects:N,simplifyRange:P,subset:_,SemVer:s,re:t.re,src:t.src,tokens:t.t,SEMVER_SPEC_VERSION:a.SEMVER_SPEC_VERSION,RELEASE_TYPES:a.RELEASE_TYPES,compareIdentifiers:r.compareIdentifiers,rcompareIdentifiers:r.rcompareIdentifiers},Ye}var jt=Gt();const Zr=ot(jt);var y;(function(t){t.blue="blue",t.nanoS="nanoS",t.nanoSP="nanoSP",t.nanoX="nanoX",t.stax="stax",t.europa="europa"})(y||(y={}));const We={[y.blue]:{id:y.blue,productName:"Ledger Blue",productIdMM:0,legacyUsbProductId:0,usbOnly:!0,memorySize:480*1024,masks:[822083584,822149120],getBlockSize:t=>4*1024},[y.nanoS]:{id:y.nanoS,productName:"Ledger Nano S",productIdMM:16,legacyUsbProductId:1,usbOnly:!0,memorySize:320*1024,masks:[823132160],getBlockSize:t=>{var a;return Zr.lt((a=Zr.coerce(t))!==null&&a!==void 0?a:"","2.0.0")?4*1024:2*1024}},[y.nanoX]:{id:y.nanoX,productName:"Ledger Nano X",productIdMM:64,legacyUsbProductId:4,usbOnly:!1,memorySize:2*1024*1024,masks:[855638016],getBlockSize:t=>4*1024,bluetoothSpec:[{serviceUuid:"13d63400-2c97-0004-0000-4c6564676572",notifyUuid:"13d63400-2c97-0004-0001-4c6564676572",writeUuid:"13d63400-2c97-0004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-0004-0003-4c6564676572"}]},[y.nanoSP]:{id:y.nanoSP,productName:"Ledger Nano S Plus",productIdMM:80,legacyUsbProductId:5,usbOnly:!0,memorySize:1533*1024,masks:[856686592],getBlockSize:t=>32},[y.stax]:{id:y.stax,productName:"Ledger Stax",productIdMM:96,legacyUsbProductId:6,usbOnly:!1,memorySize:1533*1024,masks:[857735168],getBlockSize:t=>32,bluetoothSpec:[{serviceUuid:"13d63400-2c97-6004-0000-4c6564676572",notifyUuid:"13d63400-2c97-6004-0001-4c6564676572",writeUuid:"13d63400-2c97-6004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-6004-0003-4c6564676572"}]},[y.europa]:{id:y.europa,productName:"Ledger Flex",productIdMM:112,legacyUsbProductId:7,usbOnly:!1,memorySize:1533*1024,masks:[858783744],getBlockSize:t=>32,bluetoothSpec:[{serviceUuid:"13d63400-2c97-3004-0000-4c6564676572",notifyUuid:"13d63400-2c97-3004-0001-4c6564676572",writeUuid:"13d63400-2c97-3004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-3004-0003-4c6564676572"}]}};y.blue,y.nanoS,y.nanoSP,y.nanoX,y.stax,y.europa;const Jr=Object.values(We),nt=11415,it=t=>{const a=Jr.find(n=>n.legacyUsbProductId===t);if(a)return a;const s=t>>8;return Jr.find(n=>n.productIdMM===s)},Ft=[],Qr={};for(const t in We){const a=We[t],{bluetoothSpec:s}=a;if(s)for(let r=0;r<s.length;r++){const n=s[r];Ft.push(n.serviceUuid),Qr[n.serviceUuid]=Qr[n.serviceUuid.replace(/-/g,"")]=Object.assign({deviceModel:a},n)}}var X=function(t,a,s,r){function n(l){return l instanceof s?l:new s(function(o){o(l)})}return new(s||(s=Promise))(function(l,o){function f(e){try{h(r.next(e))}catch(c){o(c)}}function i(e){try{h(r.throw(e))}catch(c){o(c)}}function h(e){e.done?l(e.value):n(e.value).then(f,i)}h((r=r.apply(t,a||[])).next())})};const Xt=[{vendorId:nt}],Bt=()=>Promise.resolve(!!(window.navigator&&window.navigator.hid)),W=()=>{const{hid:t}=navigator;if(!t)throw new z("navigator.hid is not supported","HIDNotSupported");return t};function at(){return X(this,void 0,void 0,function*(){const t=yield W().requestDevice({filters:Xt});return Array.isArray(t)?t:[t]})}function tr(){return X(this,void 0,void 0,function*(){return(yield W().getDevices()).filter(a=>a.vendorId===nt)})}function Vt(){return X(this,void 0,void 0,function*(){const t=yield tr();return t.length>0?t[0]:(yield at())[0]})}class B extends ct{constructor(a){super(),this.channel=Math.floor(Math.random()*65535),this.packetSize=64,this.inputs=[],this.read=()=>this.inputs.length?Promise.resolve(this.inputs.shift()):new Promise(s=>{this.inputCallback=s}),this.onInputReport=s=>{const r=Buffer.from(s.data.buffer);this.inputCallback?(this.inputCallback(r),this.inputCallback=null):this.inputs.push(r)},this._disconnectEmitted=!1,this._emitDisconnect=s=>{this._disconnectEmitted||(this._disconnectEmitted=!0,this.emit("disconnect",s))},this.exchange=s=>X(this,void 0,void 0,function*(){return yield this.exchangeAtomicImpl(()=>X(this,void 0,void 0,function*(){const{channel:n,packetSize:l}=this;sr("apdu","=> "+s.toString("hex"));const o=dt(n,l),f=o.makeBlocks(s);for(let e=0;e<f.length;e++)yield this.device.sendReport(0,f[e]);let i,h;for(;!(i=o.getReducedResult(h));)try{const e=yield this.read();h=o.reduceResponse(h,e)}catch(e){if(e instanceof z&&e.id==="InvalidChannel")continue;throw e}return sr("apdu","<= "+i.toString("hex")),i})).catch(n=>{throw n&&n.message&&n.message.includes("write")?(this._emitDisconnect(n),new ut(n.message)):n})}),this.device=a,this.deviceModel=typeof a.productId=="number"?it(a.productId):void 0,a.addEventListener("inputreport",this.onInputReport)}static request(){return X(this,void 0,void 0,function*(){const[a]=yield at();return B.open(a)})}static openConnected(){return X(this,void 0,void 0,function*(){const a=yield tr();return a.length===0?null:B.open(a[0])})}static open(a){return X(this,void 0,void 0,function*(){yield a.open();const s=new B(a),r=n=>{a===n.device&&(W().removeEventListener("disconnect",r),s._emitDisconnect(new lt))};return W().addEventListener("disconnect",r),s})}close(){return X(this,void 0,void 0,function*(){yield this.exchangeBusyPromise,this.device.removeEventListener("inputreport",this.onInputReport),yield this.device.close()})}setScrambleKey(){}}B.isSupported=Bt;B.list=tr;B.listen=t=>{let a=!1;Vt().then(r=>{if(!r)t.error(new nr("Access denied to use Ledger device"));else if(!a){const n=typeof r.productId=="number"?it(r.productId):void 0;t.next({type:"add",descriptor:r,deviceModel:n}),t.complete()}},r=>{t.error(new nr(r.message))});function s(){a=!0}return{unsubscribe:s}};export{B as default};
